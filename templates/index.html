{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Machine Learning Prediction</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    {% csrf_token %}

<style>
   .jok{
    border: 2px solid black;
    padding: 1px; 
   }

   body{
    background-color: gray;
    width: 100%;
    
   }
   #predictionResult{
    font-size: larger;
    font-weight: bold;
    text-align: center;
    padding-top: 2px;
   }
   .footer {
    position: fixed;
    bottom: 0;
    width: 100%;
} 
</style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">
            Linear Regression ML Project
          </a>
        </div>
      </nav>

      <div class="container">
        <h1 class="text-center fw-bold pt-4"> Bengaluru House Price Prediction</h1>
      </div>

      <div class="container pt-4">
        <div class="row justify-content-center">
            <!-- Left column for image -->
            <div class="col-md-8">
                <div class="card" style="width:600px;">
                    <img src="{% static '\images\C-SKYVIEW-VIEW-FLYCAM-FINAL.jpg' %}" class="card-img-top" alt="...">
                    <div class="card-body">
                      <p class="card-text">"Discover the dream house of your imagination and unveil its true worth with just a few clicks. Experience the power of precise price prediction tailored to your specifications, making your dream home a tangible reality."





                      </p>
                    </div>
                  </div>
            </div>
            <!-- Right column for form -->
            <div class="col-md-4">
                <form id="predictionForm">
                    <div class="form-group">
                        <label for="location"><h5>Location:</h5></label>
                        <select id="location" name="location" class="form-control">
                            <!-- Location options will be dynamically added here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sqft"><h5>Square Feet:</h5></label>
                        <input type="text" id="sqft" name="sqft" class="form-control" placeholder="Sqft">
                    </div>
                    <div class="form-group">
                        <label for="bath"><h5>Bathrooms:</h5></label>
                        <select id="bath" name="bath" class="form-control">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bhk"><h5>BHK:</h5></label>
                        <select id="bhk" name="bhk" class="form-control">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                    <div class="container bg-light jok mt-4 ">
                        <div class="row">
                            <div class="col-md-6">
                                <button class="btn btn-success  w-100" type="submit">Predict Price</button>
                            </div> 
                            <div class="col-md-6">
                                <div id="predictionResult"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
    
    
    

    <script>
        // Function to populate location options
        function populateLocationOptions() {
            $.getJSON('/locations/', function(data) {
                var options = '';
                $.each(data.locations, function(index, location) {
                    options += '<option value="' + location + '">' + location + '</option>';
                });
                $('#location').html(options);
            });
        }

        // Populate location options when the page loads
        $(document).ready(function() {
            populateLocationOptions();
        });

        // AJAX request to handle form submission
        $(document).ready(function() {
    $('#predictionForm').submit(function(event) {
        event.preventDefault(); // Prevent default form submission
        var formData = $(this).serialize(); // Serialize form data
        var csrftoken = $("[name=csrfmiddlewaretoken]").val(); // Retrieve CSRF token

        $.ajax({
            type: 'POST',
            url: '/predict/',
            data: formData,
            beforeSend: function(xhr, settings) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken); // Set CSRF token in request header
            },
            success: function(response) {
                console.log(response); // Log the entire response object
                if ('prediction' in response) {
                    $('#predictionResult').text('\u20B9' + response.prediction + 'Lakh'); // Update prediction result
                } else {
                    $('#predictionResult').text('Prediction unavailable'); // Display message if prediction is unavailable
                }
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText); // Log any errors to the console
            }
        });
    });
});
    </script>



<footer class="footer bg-dark text-light text-center py-2">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <p>Email: zack@example.com</p>
            </div>
            <div class="col-md-4">
                <p>Phone: +1234567890</p>
            </div>
            <div class="col-md-4">
                <p>&copy; 2024 Your Company Name</p>
            </div>
        </div>
    </div>
</footer>
</body>
</html>
